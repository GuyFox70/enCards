class Helper{constructor(){}createElement(t){return document.createElement(t)}addText(t,e){t.innerHTML=e}getInt(t){return parseInt(t)}getFloat(t){return parseFloat(t)}toJson(t){return JSON.stringify(t)}fromJson(t){return JSON.parse(t)}getSelector(t){return document.querySelector(t)}getSelectorAll(t){return document.querySelectorAll(t)}getAttr(t,e){return t.getAttribute(e)}setAttr(t,e,s){t.setAttribute(e,s)}rmAttr(t,e){t.removeAttribute(e)}sendFetch(t,e,s){fetch(t,e).then(t=>{if(t.ok)return t.json();s(new Error("Fetch is failed!"))}).then(t=>{t.state?s(null,t.data):s(new Error("Somethins wrong with response!"))}).catch(t=>alert(t.message))}setEventElement(t,e,s){t.addEventListener(e,s)}addClass(e,t){Array.isArray(t)?t.forEach(t=>e.classList.add(t)):e.classList.add(t)}rmClass(t,e){t.classList.remove(e)}hasClass(t,e){return t.classList.contains(e)}}export default Helper;class Menu extends Helper{#menuItem;#topBtMenu;#menu;#i;#partSpeech;#words;#limit;#skip;#card;constructor(t){super(),this.#menuItem=super.getSelectorAll(".menu__item"),this.#topBtMenu=super.getSelector("#topBtMenu"),this.#menu=super.getSelector("#menu"),this.#partSpeech=super.getAttr(super.getSelector(".activeTab"),"data-partSpeech"),this.#i=0,this.#words=super.fromJson(localStorage.getItem("words"))||null,this.#skip=super.getInt(localStorage.getItem("skip"))||0,this.#limit=super.getInt(localStorage.getItem("limit"))||100,this.#card=t}getSkip(){return this.#skip}getLimit(){return this.#limit}getPartSpeech(){return this.#partSpeech}getWords(){return this.#words}setLimit(t){this.#limit=t}setWords(t){this.#words=t}requestWordsFromDB(t,e,s){const i=new FormData;i.set("skip",t),i.set("limit",e),i.set("partSpeech",this.#partSpeech),this.sendFetch("/getWords",{method:"POST",body:i},(t,e)=>{t?s(t):s(null,e)})}#addEventItemsMenu(){for(const t of this.#menuItem)this.setEventElement(t,"click",()=>{this.#partSpeech!==this.getAttr(t,"data-partSpeech")&&(this.#menuItem.forEach(t=>this.removeClass(t,"activeTab")),this.addClass(t,"activeTab"),this.#partSpeech=this.getAttr(t,"data-partSpeech"),this.removeAttr(this.#menu,"style"),this.removeClass(this.#topBtMenu,"activeItem"),this.#i--,this.requestWordsFromDB(this.#skip,this.#limit,(t,e)=>{t?alert(t.message):(this.#words=e,this.#card.setI(0),this.#card.setWordToField(this.#words,this.#partSpeech))}))})}init(){null===this.#words?this.requestWordsFromDB(this.#skip,this.#limit,(t,e)=>{t?alert(t.message):(this.#words=e,this.#card.setWordToField(this.#words,this.#partSpeech))}):this.#card.setWordToField(this.#words,this.#partSpeech),this.#addEventItemsMenu(),this.setEventElement(this.#topBtMenu,"click",()=>{this.#i?(this.rmClass(this.#topBtMenu,"activeItem"),this.rmAttr(this.#menu,"style"),this.#i--):(this.addClass(this.#topBtMenu,"activeItem"),this.setAttr(this.#menu,"style","left: 0; transition: left .3s linear;"),this.#i++)})}}class Pages extends Helper{#totalPage;constructor(){super(),this.#totalPage=super.getSelector("#totalPage"),this.amountWords={}}queryAmountWords(){const t=new FormData,s=this.getAttr(this.getSelector(".activeTab"),"data-partSpeech");t.set("partSpeech",s),this.amountWords[s]?(this.#totalPage.innerHTML=this.amountWords[s],this.setAttr(this.#totalPage,"data-pages",this.amountWords[s])):this.sendFetch("/getAmount",{method:"POST",body:t},(t,e)=>{t?(alert(t.message),this.#totalPage.innerHTML=0,this.setAttr(this.#totalPage,"data-pages",0)):(this.amountWords[s]=e,this.#totalPage.innerHTML=this.amountWords[s],this.setAttr(this.#totalPage,"data-pages",this.amountWords[s]))})}init(){this.queryAmountWords()}}class AmountWords extends Helper{#amountField;#nextAmount;#prevAmount;#step;#maxAmount;#minAmount;#amount;#currentPage;#maxAmountPages;#minAmountPages;constructor(){super(),this.#amountField=super.getSelector("#amountField"),this.#nextAmount=super.getSelector("#nextAmount"),this.#prevAmount=super.getSelector("#prevAmount"),this.#step=10,this.#maxAmount=100,this.#minAmount=10,this.#amount=super.getInt(localStorage.getItem("limit"))||this.#maxAmount,this.#currentPage=super.getSelector("#currentPage"),this.#maxAmountPages=1,this.#minAmountPages=1}#checkLimit(t){t<=this.#minAmount?(this.#amount=this.#minAmount,this.#prevAmount.disabled=!0):t>=this.#maxAmount?(this.#amount=this.#maxAmount,this.#nextAmount.disabled=!0):(this.rmAttr(this.#prevAmount,"disabled"),this.rmAttr(this.#nextAmount,"disabled")),this.setAttr(this.#amountField,"data-value",this.#amount),this.#amountField.innerHTML=this.#amount}init(s,i,r){this.#checkLimit(this.#amount),this.#amountField.innerHTML=this.#amount,this.setAttr(this.#amountField,"data-value",this.#amount),this.setEventElement(this.#nextAmount,"click",()=>{this.#amount=this.#amount+this.#step,this.#checkLimit(this.#amount),i.setLimit(this.#amount),i.requestWordsFromDB(i.getSkip(),this.#amount,(t,e)=>{t?alert(t.message):(i.setWords(e),this.hasClass(s.getFlipCard(),"hidden")?r.createTable(i.getWords(),i.getPartSpeech()):(s.resetCounter(),s.setWordToField(i.getWords(),i.getPartSpeech())))})}),this.setEventElement(this.#prevAmount,"click",()=>{this.#amount=this.#amount-this.#step,this.#checkLimit(this.#amount),i.setLimit(this.#amount),i.requestWordsFromDB(i.getSkip(),this.#amount,(t,e)=>{t?alert(t.message):(i.setWords(e),this.hasClass(s.getFlipCard(),"hidden")?r.createTable(i.getWords(),i.getPartSpeech()):(s.resetCounter(),s.setWordToField(i.getWords(),i.getPartSpeech())))})})}}class Card extends Helper{#flipCard;#flipCardInner;#eng;#mistakeReport;#btnsendReport;#btnCancelReport;#btnPrev;#btnKnow;#btnNext;#i;#j;#wordField;#translateField;constructor(){super(),this.#flipCard=super.getSelector("#flipCard"),this.#eng=super.getSelector("#eng"),this.#mistakeReport=super.getSelector("#mistakeReport"),this.#btnsendReport=super.getSelector("#sendReport"),this.#btnCancelReport=super.getSelector("#cancelReport"),this.#btnPrev=super.getSelector("#prevWord"),this.#btnKnow=super.getSelector("#knowWord"),this.#btnNext=super.getSelector("#nextWord"),this.#wordField=super.getSelector("#wordField"),this.#translateField=super.getSelector("#translateField"),this.#flipCardInner=super.getSelector("#flipCardInner"),this.#i=0,this.#j=0}getFlipCard(){return this.#flipCard}getWordField(){return this.#wordField}getTranslateField(){return this.#translateField}resetCounter(){this.#i=0}setWordToField(t,e){setTimeout(()=>{null===t||0===t.length?(alert("Empty"),this.#wordField.innerHTML="Example",this.#translateField.innerHTML="Пример"):(this.#wordField.innerHTML=t[this.#i].word,this.#translateField.innerHTML=t[this.#i].translate[e].join(", "))},0)}init(e){this.setEventElement(this.#flipCard,"click",t=>{this.#j?(this.rmClass(this.#flipCardInner,"flip-card__inner-back"),this.#j--):(this.addClass(this.#flipCardInner,"flip-card__inner-back"),this.#j++)}),this.setEventElement(this.#btnPrev,"click",t=>{t.stopPropagation(),this.#i--,this.#i<0&&(this.#i=e.getLimit()-1),this.setWordToField(e.getWords(),e.getPartSpeech())}),this.setEventElement(this.#btnKnow,"click",t=>{t.stopPropagation(),console.log("push")}),this.setEventElement(this.#btnNext,"click",t=>{t.stopPropagation(),this.#i++,this.#i>=e.getLimit()&&(this.#i=0),this.setWordToField(e.getWords(),e.getPartSpeech())})}}class TopButtons extends Helper{#btnStudeid;#btnCard;#btnTable;#activeItem;#table;#tbody;constructor(){super(),this.#btnStudeid=super.getSelector("#btnStudeid"),this.#btnCard=super.getSelector("#btnCard"),this.#btnTable=super.getSelector("#btnTable"),this.#activeItem=this.#btnCard,this.#table=this.getSelector("#table"),this.#tbody=super.getSelector("#table .table__tbody")}#rmActive(){this.rmClass(this.#activeItem,"activeItem")}createTable(e,s){if(this.addText(this.#tbody,""),null!==e&&0!==e.length&&!this.hasClass(this.#table,"hidden")){this.#rmActive(),this.addClass(this.#btnTable,"activeItem");for(let t=0;t<e.length;t++){const r=e[t],a=this.createElement("div");this.addClass(a,"table__tr");var i=this.createElement("td"),i=(this.addClass(i,["table__td","cell__number"]),this.addText(i,t+1),a.appendChild(i),this.createElement("td")),i=(this.addClass(i,["table__td","cell__word"]),this.addText(i,r.word),a.appendChild(i),this.createElement("td")),i=(this.addClass(i,["table__td","cell__transcription"]),this.addText(i,r.transcription),a.appendChild(i),this.createElement("td"));this.addClass(i,["table__td","cell__translate"]),this.addText(i,r.translate[s].join(", ")),a.appendChild(i),this.#tbody.appendChild(a)}this.#activeItem=this.#btnTable}}init(e,s){this.setEventElement(this.#btnStudeid,"click",t=>{this.hasClass(this.#btnStudeid,"activeItem")||(this.#rmActive(),this.addClass(this.#btnStudeid,"activeItem"),this.#activeItem=this.#btnStudeid)}),this.setEventElement(this.#btnCard,"click",t=>{this.hasClass(this.#btnCard,"activeItem")||(this.#rmActive(),this.addClass(this.#btnCard,"activeItem"),s.resetCounter(),s.setWordToField(e.getWords(),e.getPartSpeech()),this.addClass(this.#table,"hidden"),this.rmClass(s.getFlipCard(),"hidden"),this.#activeItem=this.#btnCard)}),this.setEventElement(this.#btnTable,"click",t=>{this.hasClass(this.#btnTable,"activeItem")||(this.addClass(s.getFlipCard(),"hidden"),this.rmClass(this.#table,"hidden"),this.createTable(e.getWords(),e.getPartSpeech()))})}}document.addEventListener("DOMContentLoaded",()=>{class t extends Helper{constructor(){super()}init(){try{const t=new Card,e=new Menu(t),s=new Pages,i=new AmountWords,r=new TopButtons;e.init(),s.init(),i.init(t,e,r),t.init(e),r.init(e,t),window.addEventListener("beforeunload",()=>{null!==e.getWords()&&localStorage.setItem("words",this.toJson(e.getWords())),localStorage.setItem("skip",e.getSkip()),localStorage.setItem("limit",e.getLimit())})}catch(t){console.log(t),alert(t.message)}}}const e=new t;e.init()});